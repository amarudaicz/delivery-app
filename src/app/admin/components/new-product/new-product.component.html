
<div>
  <div class="card new-product">
    <div class="container-form">
  
      <form class="form-new-product" [formGroup]="form"  >
        <div class="container-inputs">

          <div class="d-flex mb-2" style="justify-content: space-between;">
            <h1 class="mb-2" id="newProduct">Nuevo producto</h1>
  
     

          </div>

          
          <div id="initialForm">
            <mat-form-field  appearance="outline"  class="input-group" color="primary">
              <mat-label>Nombre</mat-label>
              <input type="text" matInput formControlName="name" />
              <mat-error>Este campo es requerido</mat-error>
            </mat-form-field>
    
            <mat-form-field class="input-group" appearance="outline">
              <mat-label>Categoria</mat-label>
  
              <mat-select formControlName="category_id">
                <mat-option *ngFor="let cat of categories" [value]="cat.id">
                  <div class="container-select-category">
                    {{ cat.category_name }}
    
                    <img [src]="cat.category_image" width="40px" alt="">
  
                  </div>
                </mat-option>
              </mat-select>
  
              <mat-error>Este campo es requerido</mat-error>
  
            </mat-form-field>
            
            <mat-form-field
            appearance="outline"
            matTooltipClass="tooltip-price" 
            matTooltipPosition="above" 
            matTooltip="El precio ingresado se utilizarÃ¡ para mostrar el valor base del producto en la vista preliminar, Si existen factores que incrementen el precio final deberas crear un Grupo de opciones e incluir el valor minimo en una opcion." 
            class="input-group" color="primary">
              <mat-label>Precio base</mat-label>
              <span matTextPrefix>$&nbsp;</span>

              <input formControlName="price" type="number" matInput />
              <mat-error>Este campo es requerido</mat-error>
            </mat-form-field>
  
    
            <mat-form-field class="input-group full-input"  appearance="outline">
              <mat-label>Ingredientes (Opcional)</mat-label>
              <mat-chip-grid #chipGrid aria-label="Enter Ingredientes">
                <mat-chip-row
                  *ngFor="let i of ingredientsList"
                  id="ingredients"
                  (removed)="remove(i, $event)"
                  [editable]="true"
                  (edited)="edit(i, $event)"
                  [aria-description]="'press enter to edit ' + i"
                >
                  {{ i }}
                  <button matChipRemove [attr.aria-label]="'remove ' + i">
                    <mat-icon>X</mat-icon>
                  </button>
                </mat-chip-row>
                <input
                  formControlName="ingredients"
                  placeholder="Nuevo Ingrediente"
                  id="ingredients"
                  [matChipInputFor]="chipGrid"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  [matChipInputAddOnBlur]="true"
                  (matChipInputTokenEnd)="add($event)"
                />
              </mat-chip-grid>
            </mat-form-field>
    
            <!-- DESCRIPCION///////////////////////////////// -->
            
            <div class="inputs-inline">
              
              <mat-form-field  appearance="outline">
                <mat-label>Descripcion (Opcional)</mat-label>
                <textarea maxlength="150" #textarea formControlName="description" matInput></textarea>
                <mat-hint>Max 150 caracteres/{{textarea.value.length}} </mat-hint>
              </mat-form-field>
      
              <div class="container-input-image">
                  <label for="previewImageProduct" class="load-image-text" *ngIf="!previewImageProduct">Carga la imagen de tu producto</label>
                  <p-fileUpload *ngIf="!previewImageProduct" chooseIcon="pi pi-upload" (uploadHandler)="uploadImage($event)" [auto]="true" #inputImage [customUpload]="true" chooseLabel="Imagen" mode="basic" accept="image/*" [maxFileSize]="1000000">
                  </p-fileUpload>
                  
                  <ul *ngIf="previewImageProduct">
                    <img [src]="previewImageProduct" alt="" width="150px">
                    <p-button icon="pi pi-times" class="button-remove-image" (click)="removePreviewImage()" ></p-button>
                  </ul>
              </div>
          </div>
          </div>  
          
        </div>


        <div>
          <h3 class="mt-4 title">Opciones</h3>
          <p class="">Agrega los grupos de opciones disponibles para el producto {{form.get('name')?.value}}</p>
          <a class="link mb-2" (click)="creatingGroup = true">Crear grupo</a>
          <app-add-group-option (closeForm)="creatingGroup = false" *ngIf="creatingGroup"></app-add-group-option>
 
          <app-set-options-product (emitterSelectedOptions)="getOptionsSelected($event)"></app-set-options-product>
        </div>

        <div class="mt-3 container-buttons-save">
          <button type="submit" (click)="saveProduct()" [disabled]="processLoad" pButton pRipple class="button-save-product">
            Guardar
          </button>
  
          <p-button
          [disabled]="processLoad" 
          class="button-preview-product"
            (click)="showPreview()"
            type="submit"
            styleClass="p-button-secondary"
          >
            Vista previa</p-button
          >
        </div>
  

        
     
      </form>
    </div>
  </div>

</div>
